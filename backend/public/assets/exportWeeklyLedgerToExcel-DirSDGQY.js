import{x as a}from"./index-DyD-220U.js";function g(f,s){const c=a.utils.book_new(),t=[],i=[];let l=0;s.owners.forEach(o=>{t.push([o.owner_name]),i.push({s:{r:l,c:0},e:{r:l,c:6}}),l++,t.push([]),l++,t.push(["DATE","MATERIAL","QTY","RATE","AMOUNT","PAID","BALANCE"]),l++,o.entries.forEach(e=>{const r=p(e.date);e.items.forEach((h,d)=>{t.push([d===0?r:"",h.material,h.qty??"",h.rate??"",h.total??"",d===0&&e.paid?e.paid:"",""]),l++}),t.push(["","TOTAL","","",e.day_total,e.paid||"",e.balance]),l++}),t.push([]),l++});const n=a.utils.aoa_to_sheet(t);n["!merges"]=i,n["!cols"]=[{wch:14},{wch:20},{wch:8},{wch:10},{wch:14},{wch:14},{wch:16}];for(let o=0;o<t.length;o++)for(let e=0;e<7;e++){const r=a.utils.encode_cell({r:o,c:e});n[r]&&(t[o].length===1&&(n[r].s={font:{sz:22,bold:!0},alignment:{horizontal:"center",vertical:"center"}}),t[o][0]==="DATE"&&t[o][1]==="MATERIAL"&&(n[r].s={font:{bold:!0},alignment:{horizontal:"center"},border:{top:{style:"thin"},bottom:{style:"thin"}}}),t[o][1]==="TOTAL"&&(n[r].s={font:{bold:!0},fill:{fgColor:{rgb:"FFFDE68A"}},border:{top:{style:"thin"},bottom:{style:"thin"}}}),e===6&&t[o][1]==="TOTAL"&&(n[r].s={font:{bold:!0},fill:{fgColor:{rgb:"FFDCFCE7"}},alignment:{horizontal:"right"}}))}a.utils.book_append_sheet(c,n,"Weekly Ledger"),a.writeFile(c,`${f}.xlsx`)}function p(f){const s=new Date(f),c=String(s.getDate()).padStart(2,"0"),t=String(s.getMonth()+1).padStart(2,"0"),i=s.getFullYear();return`${c}/${t}/${i}`}export{g as exportWeeklyLedgerToExcel};
